# 배치 그룹

- EC2 인스턴스가 AWS 인프라에 배치되는 방식을 제어하고자 할 때 사용
- AWS의 하드웨어와 직접적인 상호작용은 하지 않음
- 하지만 EC2 인스턴스가 각각 어떻게 배치 되는지 AWS에 알려줌
- 따라서 배치 그룹을 만들 때 3가지 전략을 사용할 수 있음

### 1. 클러스터 배치 그룹 (Placement Groups Cluster)

![1.png](%EB%B0%B0%EC%B9%98%20%EA%B7%B8%EB%A3%B9%2035d58956d4c44b1a918d467d2f2d1862%2F1.png)

- 단일 가용 영역 내에서 지연 시간이 짧은 하드웨어 설정으로 인스턴스를 그룹화
- **높은 성능**을 제공
- 높은 위험도를 지님, **장애가 발생하면 모든 인스턴스에 영향**
- 모든 EC2 인스턴스가 **동일한 Rack**에 있음
    - 동일한 하드웨어와 동일한 가용 영역에 있다는 뜻
- 높은 대역폭과 짧은 지연 시간이 필요한 작업에 유용

### 2. Placement Groups Spread (분산 배치 그룹)

![2.png](%EB%B0%B0%EC%B9%98%20%EA%B7%B8%EB%A3%B9%2035d58956d4c44b1a918d467d2f2d1862%2F2.png)

- **모든 인스턴스가 다른 하드웨어에 분산됨**
    - 따라서 인스턴스간 네트워킹이 지연됨
- 가용 영역별로 분산된 배치 그룹당 **7개**의 EC2 인스턴스만 가질 수 있음
    - 배치 그룹의 규모에 제한이 있음
- **동시 실패의 위험이 감소**
- 오류를 격리해야하는 Critical applications가 있는 경우 사용
- 크기가 적당한 애플리케이션에만 사용 가능
- **가용성을 극대화**하고 위험을 줄여야하는 애플리케이션에 사용

### 3. Placement Groups Partition (분할 배치 그룹)

![3.png](%EB%B0%B0%EC%B9%98%20%EA%B7%B8%EB%A3%B9%2035d58956d4c44b1a918d467d2f2d1862%2F3.png)

- 분산 배치 그룹과 비슷하게 인스턴스를 분산
- 가용 영역(AZ)에 여러 **파티션(최대 7개)**에 인스턴스가 분할
- 파티션은 가용 영역 내의 다양한 하드웨어 racks 세트에 의존
- 파티션이 많으면 인스턴스가 여러 하드웨어 Rack에 분산되어 **각 Rack의 오류로부터 안전**
    - 파티션2가 다운되어도 파티션1은 정상
    - 하지만 인스턴스 간 네트워킹이 지연됨
- 파티션은 동일한 Region의 여러 가용 영역(AZ)에 걸쳐있을 수 있음
- 즉 그룹 당 수백 개의 EC2 인스턴스를 통해 확장할 수 있음
    - 이를 통해 Hadoop, Cassandra, Kafka 같은 애플리케이션 실행 가능
- 메타데이터 서비스를 통해 특정 EC2 인스턴스가 어떤 파티션에 있는지 알 수 있음
- 파티션들 전반에 걸쳐 데이터와 서버를 퍼뜨려 두어도 파티션 인식이 가능한 애플리케이션에 사용
    - HDFS, Hbase, Cassandra, Kafak

### [배치 그룹 만들기 ]
![4.png](%EB%B0%B0%EC%B9%98%20%EA%B7%B8%EB%A3%B9%2035d58956d4c44b1a918d467d2f2d1862%2F4.png)

- 인스턴스 생성하는 화면에서 배치 그룹을 설정 할 수 있다.

![5.png](%EB%B0%B0%EC%B9%98%20%EA%B7%B8%EB%A3%B9%2035d58956d4c44b1a918d467d2f2d1862%2F5.png)